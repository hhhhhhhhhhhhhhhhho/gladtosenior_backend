# ğŸ“š Deep Agent ìì„œì „ ìƒì„± API

LangChain + LangGraphë¥¼ í™œìš©í•œ Deep Agent ê¸°ë°˜ ìì„œì „ ìƒì„± ë°±ì—”ë“œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

ìŒì„± ë˜ëŠ” í…ìŠ¤íŠ¸ë¡œ ì…ë ¥ëœ ì¼ëŒ€ê¸°ë¥¼ ë¶„ì„í•˜ì—¬, ì¸ìƒ ì‹œê¸°ë³„ ì „ë¬¸ ì—ì´ì „íŠ¸ë“¤ì´ í˜‘ë ¥í•˜ì—¬ ì™„ì„±ë„ ë†’ì€ ìì„œì „ì„ ìƒì„±í•©ë‹ˆë‹¤.

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

- **FastAPI ê¸°ë°˜ REST API**: í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ì„ ìœ„í•œ API ì„œë²„
- **ë©€í‹° ì—ì´ì „íŠ¸ ì•„í‚¤í…ì²˜**: 5ê°œì˜ ì¸ìƒ ì‹œê¸°ë³„ ì „ë¬¸ ì—ì´ì „íŠ¸ + ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì—ì´ì „íŠ¸
- **LangGraph ì›Œí¬í”Œë¡œìš°**: ìƒíƒœ ê¸°ë°˜ ê·¸ë˜í”„ë¡œ ì—ì´ì „íŠ¸ ì¡°ìœ¨
- **ë¹„ë™ê¸° ì²˜ë¦¬ ì§€ì›**: ê¸´ ì‘ì—…ì„ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì²˜ë¦¬
- **ìŒì„± ë³€í™˜ ì§€ì›**: Whisper APIë¥¼ í†µí•œ ìŒì„±â†’í…ìŠ¤íŠ¸ ë³€í™˜
- **CORS ì„¤ì •**: í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì„œë²„ì™€ ì—°ë™ ê°€ëŠ¥

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FastAPI Server                            â”‚
â”‚                  (REST API ì—”ë“œí¬ì¸íŠ¸)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LangGraph ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°                         â”‚
â”‚           (ìƒíƒœ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš° ê´€ë¦¬)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë¶„ì„      â”‚  â”‚  í†µí•©      â”‚  â”‚  ì‹œê¸°ë³„    â”‚
â”‚  ì—ì´ì „íŠ¸   â”‚  â”‚  ì—ì´ì „íŠ¸   â”‚  â”‚  ì—ì´ì „íŠ¸   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                    â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         â”‚           â”‚           â”‚         â”‚
              â–¼         â–¼           â–¼           â–¼         â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ ìœ ë…„ê¸°  â”‚ â”‚ ì²­ë…„ê¸°  â”‚ â”‚ ì¤‘ë…„ê¸°  â”‚ â”‚ ì¥ë…„ê¸°  â”‚ â”‚ ë…¸ë…„ê¸°  â”‚
         â”‚ 0-12ì„¸ â”‚ â”‚ 13-29ì„¸â”‚ â”‚ 30-49ì„¸â”‚ â”‚ 50-64ì„¸â”‚ â”‚ 65ì„¸+  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ ì„¤ì¹˜

### 1. ì €ì¥ì†Œ í´ë¡ 

```bash
git clone https://github.com/your-repo/gladtosenior_backend.git
cd gladtosenior_backend
```

### 2. ê°€ìƒí™˜ê²½ ìƒì„± (ê¶Œì¥)

```bash
python -m venv venv

# Windows
venv\Scripts\activate

# macOS/Linux
source venv/bin/activate
```

### 3. ì˜ì¡´ì„± ì„¤ì¹˜

```bash
pip install -r requirements.txt
```

ë˜ëŠ” uv ì‚¬ìš©:

```bash
uv pip install -r requirements.txt
```

### 4. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
# .env.exampleì„ ë³µì‚¬í•˜ì—¬ .env ìƒì„±
cp .env.example .env

# .env íŒŒì¼ í¸ì§‘í•˜ì—¬ OpenAI API í‚¤ ì„¤ì •
OPENAI_API_KEY=sk-your-api-key-here
OPENAI_MODEL=gpt-4o
```

## ğŸš€ ì„œë²„ ì‹¤í–‰

### ê°œë°œ ì„œë²„

```bash
# uvicornìœ¼ë¡œ ì‹¤í–‰ (ìë™ ë¦¬ë¡œë“œ)
uvicorn app:app --reload --host 0.0.0.0 --port 8000

# ë˜ëŠ” pythonìœ¼ë¡œ ì§ì ‘ ì‹¤í–‰
python app.py
```

### í”„ë¡œë•ì…˜ ì„œë²„

```bash
uvicorn app:app --host 0.0.0.0 --port 8000 --workers 4
```

## ğŸ“– API ë¬¸ì„œ

ì„œë²„ ì‹¤í–‰ í›„ ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸:

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## ğŸ”Œ API ì—”ë“œí¬ì¸íŠ¸

### í—¬ìŠ¤ ì²´í¬

```http
GET /api/v1/health
```

### ìì„œì „ ìƒì„± (ë™ê¸°)

```http
POST /api/v1/autobiography/generate
Content-Type: application/json

{
  "transcript": "ì €ëŠ” 1955ë…„ ê²½ìƒë¶ë„ ì•ˆë™ì—ì„œ íƒœì–´ë‚¬ìŠµë‹ˆë‹¤..."
}
```

### ìì„œì „ ìƒì„± (ë¹„ë™ê¸°)

```http
POST /api/v1/autobiography/generate/async
Content-Type: application/json

{
  "transcript": "ì €ëŠ” 1955ë…„ ê²½ìƒë¶ë„ ì•ˆë™ì—ì„œ íƒœì–´ë‚¬ìŠµë‹ˆë‹¤..."
}

# ì‘ë‹µ: { "job_id": "uuid", "status": "pending" }
```

### ì‘ì—… ìƒíƒœ ì¡°íšŒ

```http
GET /api/v1/jobs/{job_id}
```

### ìŒì„± íŒŒì¼ ë³€í™˜

```http
POST /api/v1/transcribe
Content-Type: multipart/form-data

file: (audio file)
language: ko
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
gladtosenior_backend/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ routes.py          # API ë¼ìš°íŠ¸ ì •ì˜
â”‚   â””â”€â”€ schemas.py         # Request/Response ìŠ¤í‚¤ë§ˆ
â”œâ”€â”€ autobiography_agents/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ life_stage_agents.py    # ì¸ìƒ ì‹œê¸°ë³„ ì—ì´ì „íŠ¸ (5ê°œ)
â”‚   â””â”€â”€ orchestrator.py         # LangGraph ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ audio_transcriber.py    # ìŒì„±â†’í…ìŠ¤íŠ¸ ë³€í™˜
â”‚   â””â”€â”€ file_handler.py         # íŒŒì¼ ì…ì¶œë ¥ ì²˜ë¦¬
â”œâ”€â”€ output/                     # ìƒì„±ëœ ìì„œì „ ì €ì¥
â”œâ”€â”€ app.py                     # FastAPI ë©”ì¸ ì•±
â”œâ”€â”€ main.py                    # CLI ì‹¤í–‰ íŒŒì¼
â”œâ”€â”€ requirements.txt           # ì˜ì¡´ì„± ëª©ë¡
â”œâ”€â”€ .env.example              # í™˜ê²½ ë³€ìˆ˜ ì˜ˆì‹œ
â””â”€â”€ README.md                 # ì´ íŒŒì¼
```

## ğŸ¤– ì—ì´ì „íŠ¸ ì„¤ëª…

### ì¸ìƒ ì‹œê¸°ë³„ ì—ì´ì „íŠ¸

| ì—ì´ì „íŠ¸ | ë‹´ë‹¹ ì‹œê¸° | ì£¼ìš” ì—­í•  |
|---------|----------|----------|
| ìœ ë…„ê¸° ì—ì´ì „íŠ¸ | 0-12ì„¸ | ì¶œìƒ, ê°€ì¡±, ì–´ë¦° ì‹œì ˆ ì¶”ì–µ |
| ì²­ë…„ê¸° ì—ì´ì „íŠ¸ | 13-29ì„¸ | í•™ì°½ì‹œì ˆ, ì²«ì‚¬ë‘, ì§„ë¡œ íƒìƒ‰ |
| ì¤‘ë…„ê¸° ì—ì´ì „íŠ¸ | 30-49ì„¸ | ì§ì—…, ê²°í˜¼, ìë…€ ì–‘ìœ¡ |
| ì¥ë…„ê¸° ì—ì´ì „íŠ¸ | 50-64ì„¸ | ê²½ë ¥ ì ˆì •, ì¸ìƒì˜ ì „í™˜ì  |
| ë…¸ë…„ê¸° ì—ì´ì „íŠ¸ | 65ì„¸+ | ì€í‡´, íšŒê³ , ì¸ìƒì˜ êµí›ˆ |

### ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì—ì´ì „íŠ¸

- **ë¶„ì„ ì—ì´ì „íŠ¸**: ì…ë ¥ í…ìŠ¤íŠ¸ ë¶„ì„, ì£¼ì¸ê³µ ì •ë³´ ì¶”ì¶œ
- **í†µí•© ì—ì´ì „íŠ¸**: ê° ì±•í„°ë¥¼ í•˜ë‚˜ì˜ ì™„ì„±ëœ ìì„œì „ìœ¼ë¡œ í†µí•©
- **LangGraph ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°**: ì „ì²´ ì›Œí¬í”Œë¡œìš° ìƒíƒœ ê´€ë¦¬

## ğŸ”§ í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™

### CORS ì„¤ì •

`app.py`ì—ì„œ í”„ë¡ íŠ¸ì—”ë“œ ë„ë©”ì¸ ì¶”ê°€:

```python
app.add_middleware(
    CORSMiddleware,
    allow_origins=[
        "http://localhost:3000",      # React
        "http://localhost:5173",      # Vite
        "https://your-domain.com",    # í”„ë¡œë•ì…˜
    ],
    ...
)
```

### API í˜¸ì¶œ ì˜ˆì‹œ (JavaScript)

```javascript
// ìì„œì „ ìƒì„± (ë¹„ë™ê¸°)
const response = await fetch('http://localhost:8000/api/v1/autobiography/generate/async', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ transcript: 'ë‚˜ì˜ ì´ì•¼ê¸°...' })
});
const { job_id } = await response.json();

// ì‘ì—… ìƒíƒœ í´ë§
const checkStatus = async () => {
  const statusRes = await fetch(`http://localhost:8000/api/v1/jobs/${job_id}`);
  const status = await statusRes.json();
  
  if (status.status === 'completed') {
    console.log('ì™„ë£Œ:', status.result);
  } else if (status.status === 'failed') {
    console.error('ì‹¤íŒ¨:', status.error);
  } else {
    setTimeout(checkStatus, 5000); // 5ì´ˆ í›„ ì¬í™•ì¸
  }
};
checkStatus();
```

## âš™ï¸ í™˜ê²½ ë³€ìˆ˜

| ë³€ìˆ˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|-----|------|-------|
| `OPENAI_API_KEY` | OpenAI API í‚¤ | (í•„ìˆ˜) |
| `OPENAI_MODEL` | ì‚¬ìš©í•  ëª¨ë¸ | gpt-4o |
| `AUDIO_LANGUAGE` | ì˜¤ë””ì˜¤ ì–¸ì–´ | ko |

## ğŸ”— ê¸°ìˆ  ìŠ¤íƒ

- **FastAPI**: ê³ ì„±ëŠ¥ ë¹„ë™ê¸° ì›¹ í”„ë ˆì„ì›Œí¬
- **LangChain**: LLM ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë ˆì„ì›Œí¬
- **LangGraph**: ìƒíƒœ ê¸°ë°˜ ì—ì´ì „íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
- **OpenAI GPT**: í…ìŠ¤íŠ¸ ìƒì„± ëª¨ë¸
- **Whisper**: ìŒì„±-í…ìŠ¤íŠ¸ ë³€í™˜
- **Pydantic**: ë°ì´í„° ê²€ì¦
- **Uvicorn**: ASGI ì„œë²„

## ğŸ“„ ë¼ì´ì„ ìŠ¤

MIT License

## ğŸ¤ ê¸°ì—¬

ì´ìŠˆ ë° PR í™˜ì˜í•©ë‹ˆë‹¤!
